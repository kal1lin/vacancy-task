Архитектура системы PUSH уведомлений

Этапы отправки:

1. Триггер события (заказ в корзине, смена статуса, рекламная кампания)
2. Событие попадает в очередь сообщений (RabbitMQ/Kafka)
3. Service Worker получает событие из очереди
4. Подготовка данных уведомления
5. Отправка в Firebase Cloud Messaging (FCM)
6. FCM передает уведомление на девайс
7. Мобильное приложение получает и отображает пуш

Компоненты системы:

- API сервер: генерирует события
- Message Queue: хранит события в очереди
- Push Service: обработчик уведомлений
- Firebase FCM: доставка на устройства
- Mobile App: получатель

Обработка ошибок:

- Если девайс офлайн: пуш сохраняется в FCM до 4 недель
- Если сервис упал: события остаются в очереди
- Retry механизм: повтор отправки через 5, 15, 60 минут

Мониторинг:

- Логирование всех событий
- Метрики доставки (отправлено/получено)
- Алерты при ошибках отправки > 5%

Примерflow: пользователь добавляет товар -> API создает событие -> очередь -> Service -> FCM -> мобильное приложение показывает пуш
